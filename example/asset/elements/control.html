<script src="/bower_components/lodash/dist/lodash.js"></script>
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/core-ajax/core-ajax.html">
<link rel="import" href="/bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="/bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="/bower_components/paper-tabs/paper-tabs.html">

<polymer-element name="cheapgl-controlpanel">
<template>

<core-ajax url="../shaders.json" auto response="{{shaders}}"></core-ajax>
<core-ajax url="../models.json" auto response="{{models}}"></core-ajax>
<core-ajax url="../app/{{vertShader}}" auto response="{{vertSource}}"></core-ajax>
<core-ajax url="../app/{{fragShader}}" auto response="{{fragSource}}"></core-ajax>

<div id="left">

<textarea class="source" value="{{vertSource}}" cols="80" rows="20" style="float: left">
</textarea>
<textarea class="source" value="{{fragSource}}" cols="80" rows="20">
</textarea>

</div> <!-- end left -->

<div id="right">

<table>

<tr>
<td><label for="select-model">モデル選択</label></td>
<td>

<select value="{{modelId}}">
<template repeat="{{model in models}}">
<option value="{{model.id}}">{{model.name}}</option>
</template>
</select>

</td>
</tr>


<tr>
<td>
<label for="select-shader">シェーダー選択</label>
</td>

<td>
<select value="{{shaderId}}">
<template repeat="{{shader in shaders}}">
<option value="{{shader.id}}">{{shader.shaderName}}</option>
</template>
</select>
</td>
</tr>

<tr>
<td><label for="ext">拡大</label></td>
<td><input type="text" value="1.0" id="ext"></td>
</tr>

<tr>
<td><label for="rotate">回転</label></td>
<td><input type="text" value="1.0" id="rotate"></td>
</tr>
</table>

</div> <!-- end right -->

</template>

<script>
Polymer('cheapgl-controlpanel', {
	vertShader: "passthrough-vert.js",
	fragShader: "passthrough-frag.js",
	modelsChanged: function() {
		this.modelId = "torus";
	},
	modelIdChanged: function() {
		var modelId = this.modelId;
		var m = _.find(this.models, function(model) {
				return modelId === model.id;
		});
		this.modelPath = m.path;
		this.shaderId = m.defaultShader;
	},
	shaderIdChanged: function() {
		var shaderId = this.shaderId;
		var s = _.find(this.shaders, function(shader) {
				return shaderId === shader.id;
		});
		this.vertShader = s.vert;
		this.fragShader = s.frag;
	}
});
</script>
</polymer-element>
